# Frequently Asked Questions (FAQ)

### What is iptables?
> Originally, the most popular firewall/[NAT](http://en.wikipedia.org/wiki/Network_address_translation) package running on Linux/Android was ipchains, but it had a number of shortcomings. To rectify this, the [Netfilter](http://en.wikipedia.org/wiki/Netfilter) organization decided to create a new product called iptables, giving it such improvements as:

* Better integration with the Linux kernel with the capability of loading iptables-specific kernel modules designed for improved speed and reliability.
* [Stateful packet inspection](http://en.wikipedia.org/wiki/Stateful_packet_inspection). This means that the firewall keeps track of each connection passing through it and in certain cases will view the contents of data flows in an attempt to anticipate the next action of certain protocols. This is an important feature in the support of active [FTP](http://en.wikipedia.org/wiki/FTP) and [DNS](http://en.wikipedia.org/wiki/Domain_Name_System), as well as many other network services.
* Filtering packets based on a [MAC address](http://en.wikipedia.org/wiki/MAC_address) and the values of the flags in the TCP header. This is helpful in preventing attacks using malformed packets and in restricting access from locally attached servers to other networks in spite of their IP addresses.
* System logging that provides the option of adjusting the level of detail of the reporting.
* Better network address translation.
* A rate limiting feature that helps iptables block some types of denial of service ([DoS](http://en.wikipedia.org/wiki/Denial-of-service_attack)) attacks. 

Considered a faster and more secure alternative to [ipchains](http://en.wikipedia.org/wiki/Ipchains), iptables has become the default firewall package installed under Linux and Android OS.

### Packet processing in iptables
> All packets inspected by iptables pass through a sequence of built-in tables (queues) for processing. Each of these queues is dedicated to a particular type of packet activity and is controlled by an associated packet transformation/filtering chain.

* Forward (FORWARD) chain: Filters packets to servers protected by the firewall.
* Input (INPUT) chain: Filters packets destined for the firewall.
* Output (OUTPUT) chain: Filters packets originating from the firewall. 
* Prerouting (PREROUTING) chain: Address translation occurs before routing. Facilitates the transformation of the destination IP address to be compatible with the firewall's routing table.
* Postrouting (POSTROUTING) chain: Address translation occurs after routing. This implies that there was no need to modify the destination IP address of the packet as in pre-routing.
* Output (OUTPUT) via nat: Network address translation for packets generated by the firewall.

### Is a reboot required after edit/saving linux iptables?
> Changes to iptables take effect immediately when they are run. If you are making your changes in a script, you must make sure that script gets run in order for the changes to take affect. The rules are enforced as soon as the actual commands are sent to the kernel. You will need to figure out how to run the script or apply whatever conf changes you have saved to a file. A reboot actually clears all iptables rules. On first boot the tables will always be empty, you always have to set all the rules after booting. That's what the AFwall+ automatically does (make sure it's enabled).

### Youtube/Online Radio streaming is not working anymore. How can i fix this without disabling AFWall+? 
> Please whitelist "Media Server" or remove it from your blacklist.
         
### What is the third column in the main page with "R"?  
> "R" indicates "Roaming". You can whitelist/blacklist applications when you are on roaming! 
         
### My Logs (logcat) are not displaying anything or always empty, why? 
> AFWall+ logs are depend on dmesg (kernel logs). Either your kernel disabled dmesg or it's getting overwritten quickly. Please check if you kernel does have an option like "Android logger Control" or something like that an enable this service.
         
### Can i block incoming SMS?
> **No**, you [can't block it via AFWall+](https://github.com/ukanth/afwall/issues/111), iptables can't block low level traffic.

### Can i block IPv6 traffic?
> [Sure](https://github.com/ukanth/afwall/issues/108), please use AFWall+ 1.2.4.1 or later. Some kernel have an option to disable IPv6, make sure it's enabled. Make sure you also enabled the option "Enable IPv6 support" in AFWall+ options, because this is disabled by default.

### Is there Tasker/Locale support?
> Tasker can work together with AFWall+.

### UDP Port 53 is blocked if whitelisting are enabled, why?
> Please read [this](https://github.com/ukanth/afwall/issues/18). It's **disabled by default**.

### How can i show the iptables rules?
> Via  _iptables -L_ command in apps like [Android Terminal Emulator](https://play.google.com/store/apps/developer?id=Jack+Palevich). Most roms already use this. 

### My Apps can bypass AFWall's whitelist mode before the boot are complete.
> Please read [#7](https://github.com/ukanth/afwall/issues/7), [#91](https://github.com/ukanth/afwall/issues/91). As a workaround you can try to **enable the experimental functions**.
If you want to see what is conneting during the boot take a look at the _/proc/uid_stat/_ folder.

**Important note:** procfs is mounted at boot time, which means that every time your device is rebooted  there're 0 traffic values for all UIDs. You can list _/proc/uid_stat/_ dir right now to see which UIDs have been spending traffic since last reboot.

### How do I display all available network interfaces names using bash shell prompt?
> Type _$ ip link show_.

Each network interface config is in under the /sys/class/net/ dir. If you list that dir on Android, you'll probably see [something like that](http://developer.android.com/reference/android/net/TrafficStats.html):

_$ ls sys/class/net_
_lo_

_dummy0_

_ifb0_

_ifb1_

_rmnet0_

_rmnet1_

_rmnet2_

_usb0_

_sit0_

_ip6tnl0_

_gannet0_

_tun_

_eth0_


### How can i purge the iptables rules?
> Open Android Terminal Emulator 
  1. Type _su_ to get access 
  2. iptables -F
  3. iptables -X
  4. Reboot.

You can also do this via 'Firewall Rules' -> 'flush rules'. 

### AFWall+ does not show app xyz in my list, why?
> Only apps are listed that have **internet permissions**. 

### AFWall+ does not work under CM 7.x, how can i fix this?
> Please upgrade your CM version, because this is **not supported anymore**. As a workaround you can try to update your iptables to the latest version.

### Install as regular app
> adb install afwall+.apk

Or you may also copy and download the afwall+.apk file on your device and install it using [File Explorer](https://play.google.com/store/apps/developer?id=ES+APP+Group) etc.

### Install as system app (**not recommend and only for test!**)
> adb remount
> adb push afwall+.apk /system/app

You may an also move the .APK file to the _/system/app_ directory manually. Make sure you set the file permission properly _-rw-r--r--_. To uninstall, please remove afwall+.apk from _/system/app_ manually.

### Permissions
* _RECEIVE_BOOT_COMPLETED_: Autostart (Bootup) AFWall+ after the system finishes booting.
* _ACCESS_NETWORK_STATE_: Allows AFWall+ to access information about networks (iptables).
* _WRITE_EXTERNAL_STORAGE_: Allows AFWall+ to write to external storage for debug log and export iptables rules.
* _ACCESS_SUPERUSER_: Support for SuperSU ([by Koushik](http://www.androidpolice.com/2013/02/25/koush-releases-free-open-source-superuser-app-with-support-for-multi-user-tablet-ui-x86arm-pin-and-effort-for-apps-to-declare-root-permission/)).
* _INTERNET_ : NetworkInterface.getNetworkInterfaces() needs android.permission.INTERNET. This is just being used to get the IPv4 and IPv6 addresses/subnets for each interface, so the LAN address ranges can be determined. Nothing is actually trying to access the network.
* _ACCESS_WIFI_STATE_ : Added to detect tether state.

### Disabling the firewall temporarily
If you need to disable the firewall temporarily, you can flush all the rules using
> iptables -F

Or via script
> echo "Stopping firewall and allowing everyone..."

> iptables -F

> iptables -X

> iptables -t nat -F

> iptables -t nat -X

> iptables -t mangle -F

> iptables -t mangle -X

> iptables -P INPUT ACCEPT

> iptables -P FORWARD ACCEPT

> iptables -P OUTPUT ACCEPT